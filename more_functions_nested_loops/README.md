additional functions and nested for loops